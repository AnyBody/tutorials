


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta content="noindex" name="robots" />

    <title>Lesson 4: Imparting movement with Drivers &#8212; AnyBody Tutorials v7.1.0.dev</title>
    <link rel="stylesheet" href="../_static/cloud.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="../_static/cloud.base.js"></script>
    <script type="text/javascript" src="../_static/cloud.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lesson 5: Definition of Muscles and External Forces" href="lesson5.html" />
    <link rel="prev" title="Lesson 3: Connecting Segments by Joints" href="lesson3.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../contents.html" title="Table Of Contents"
             accesskey="C">toc</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="lesson5.html" title="Lesson 5: Definition of Muscles and External Forces"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="lesson3.html" title="Lesson 3: Connecting Segments by Joints"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">AnyBody Tutorials v7.1.0.dev</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">2. Getting started: AnyScript Programming</a> &#187;</li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="lesson-4-imparting-movement-with-drivers">
<h1>Lesson 4: Imparting movement with Drivers<a class="headerlink" href="#lesson-4-imparting-movement-with-drivers" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Here’s an AnyScript file to start on if you have not completed the
previous lesson: <a class="reference download internal" href="../_downloads/demo.lesson4.any" download=""><code class="xref download docutils literal"><span class="pre">*demo.lesson4.any*</span></code></a>.</p>
</div>
<p>If you have completed the three previous lessons, you should have a
model with an upper arm grounded at the shoulder joint and connected to
a forearm by the elbow. What we want to do now is to make the arm move.</p>
<p><img alt="ModelView Arm2D initial load" src="../_images/image16.png" /></p>
<p><strong>Can an arm without muscles move? Well, in reality no, but AnyBody simulations use
the inverse dynamics technique, where we prescribe motion first and then deduce
the values of muscle forces which produce the motion.</strong></p>
<div class="section" id="measures-drivers">
<h2>Measures &amp; drivers<a class="headerlink" href="#measures-drivers" title="Permalink to this headline">¶</a></h2>
<p>We need to specify the motion for two degrees of freedom (DOF) of our arm mechanism, because it has hinge joints at the
shoulder and at the elbow.</p>
<ul class="simple">
<li><strong>Measures</strong> are AnyBody objects which literally measure the value of a specific DOF within the model.</li>
<li><strong>Drivers</strong> are AnyBody objects which constrain the value of a measure to a constant value or a mathematical function of time. <strong>Drivers</strong> essentially assemble and impart motion to your mechanisms.</li>
</ul>
<p>In this model, we therefore need two drivers, to specify motions for the two DOF. We therefore also need two measures,
which we will chose to be measures of the shoulder and elbow joint angle values.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is only important that the measures being driven represent the total independent model DOFs.
For this arm model with 2DOF remaining, we can apply motion drivers to the shoulder &amp; elbow joints OR the X and Y coordinates
of the end-point of the ForeArm segment (the wrist). Creating more than 2 driver constraints will over-constrain the model and lead to errors.</p>
</div>
</div>
<div class="section" id="creating-a-constant-velocity-joint-motion">
<h2>Creating a constant velocity joint motion<a class="headerlink" href="#creating-a-constant-velocity-joint-motion" title="Permalink to this headline">¶</a></h2>
<p>Let’s create a new folder and define two drivers:</p>
<div class="highlight-AnyScriptDoc notranslate"><div class="highlight"><pre><span></span><span class="p">};</span> <span class="c1">// Jnts folder</span>

<span class="gr">AnyFolder Drivers = {</span>
<span class="gr">  //---------------------------------</span>
<span class="gr">  AnyKinEqSimpleDriver ShoulderMotion = {</span>
<span class="gr">    AnyRevoluteJoint &amp;Jnt = ..Jnts.Shoulder;</span>
<span class="gr">    DriverPos = {-100*pi/180};</span>
<span class="gr">    DriverVel = {30*pi/180};</span>
<span class="gr">  }; // Shoulder driver</span>
<span class="gr">  //---------------------------------</span>
<span class="gr">  AnyKinEqSimpleDriver ElbowMotion = {</span>
<span class="gr">    AnyRevoluteJoint &amp;Jnt = ..Jnts.Elbow;</span>
<span class="gr">    DriverPos = {90*pi/180};</span>
<span class="gr">    DriverVel = {45*pi/180};</span>
<span class="gr">  }; // Elbow driver</span>
<span class="gr">}; // Driver folder</span>
</pre></div>
</div>
<p>The folder contains two objects named “ShoulderMotion” and “ElbowMotion”, belonging to the
“AnyKinEqSimpleDriver” class.</p>
<p><strong>All AnyBody drivers only work on the measures that are supplied to them. The “AnyKinEqSimpleDriver” used in this case, constrains
the measure positions to a given value at time = 0 (“DriverPos”) and changes this position at constant velocity thereon (“DriverVel”).</strong></p>
<p>Since the measures supplied to the above drivers are joints, the drivers produce joint rotation.
But the same driver class could be used to drive translations, for instance the cartesian
position of a point.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since these drivers drive angles, the units are radians and radians/sec.</p>
</div>
<p><strong>The following lines assign the shoulder and elbow joint angle measures to the respective drivers.
Standard AnyBody joints created using classes such as “AnyRevoluteJoint”, “AnySphericalJoint” etc. automatically function as measures.
More customized measures can be created using classes such as “AnyKinLinear”, “AnyKinRotational” etc.
(see</strong> <a class="reference internal" href="../The_mechanical_elements/lesson4.html"><span class="doc">*this lesson*</span></a>).:</p>
<div class="highlight-AnyScriptDoc notranslate"><div class="highlight"><pre><span></span><span class="kt">AnyRevoluteJoint</span> <span class="o">&amp;</span><span class="n">Jnt</span> <span class="o">=</span> <span class="p">..</span><span class="n">Jnts</span><span class="p">.</span><span class="n">Shoulder</span><span class="p">;</span>
</pre></div>
</div>
<p>and</p>
<div class="highlight-AnyScriptDoc notranslate"><div class="highlight"><pre><span></span><span class="kt">AnyRevoluteJoint</span> <span class="o">&amp;</span><span class="n">Jnt</span> <span class="o">=</span> <span class="p">..</span><span class="n">Jnts</span><span class="p">.</span><span class="n">Elbow</span><span class="p">;</span>
</pre></div>
</div>
<p>Just like in <a class="reference internal" href="lesson3.html"><span class="doc">*Lesson 3*</span></a>, these lines also
use the reference operator ‘&amp;’ to point the local variable “Jnt” towards the
actual shoulder/elbow joint objects existing in a different folder</p>
<p>Since “Jnt” is a reference, it will automatically update as the joint angles change during motion.</p>
</div>
<div class="section" id="running-simulations-making-things-move">
<h2>Running simulations - making things move!<a class="headerlink" href="#running-simulations-making-things-move" title="Permalink to this headline">¶</a></h2>
<p>Re-load the model by hitting F7, and you should see the message “Loaded successfully” with NO
warning messages about the lack of kinematic constraints. You’re now ready to get this model moving.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The object named “ArmModelStudy” (of “AnyBodyStudy” class) creates simulations to run your model through. “ArmModelStudy”
contains a reference object (created with a <strong>&amp;</strong>) pointing to the “ArmModel” folder. You can create
multiple “AnyBodyStudy” objects, each of which simulates the same mechanical model but with different motion drivers.</p>
</div>
<p><strong>Step 1</strong>: Simulations in AnyBody are termed “Studies”. To run a kinematic analysis of the model:</p>
<ul class="simple">
<li>Click on the operations drop-down menu at the top (see figure below).</li>
<li>Select “Main.ArmModelStudy.Kinematics”</li>
</ul>
<p><img alt="Operations ArmStudy" src="../_images/image24.png" /></p>
<p><strong>Step 2</strong>: Click the “Run Operation” button on the Execute toolbar. This toolbar is next to the drop-down menu, and contains three buttons
<img alt="Model tree toolbar Execute buttons" src="../_images/image33.png" />:</p>
<ul class="simple">
<li><strong>Run operation</strong>: Starts or pauses the chosen operation. Shortcut
F5.</li>
<li><strong>Step operation</strong>: Advances to next step of operation, typically a
time step. Shortcut F6.</li>
<li><strong>Stop operation</strong>: Sets the operation back to its initial position.
You must reset before you start a new analysis that was previously
aborted. Shortcut F4</li>
</ul>
<p>Since we have no muscles so far, a kinematic analysis is really all that
makes sense. With a kinematic analysis, you can investigate positions, velocities, and
accelerations. But force, power, energy or other such things are not computed. These properties are calculated by the
<strong>InverseDynamics</strong> study.</p>
</div>
<div class="section" id="replaying-a-simulation">
<h2>Replaying a simulation<a class="headerlink" href="#replaying-a-simulation" title="Permalink to this headline">¶</a></h2>
<p>While the analysis is running, you can see the model move in the Model View window.</p>
<p>When the analysis in finished, you can use the replay panel to replay
the motion as you would in a movie player.</p>
<p><img alt="Replay toolbar" src="../_images/image53.png" /></p>
</div>
<div class="section" id="fetching-simulation-results">
<h2>Fetching simulation results<a class="headerlink" href="#fetching-simulation-results" title="Permalink to this headline">¶</a></h2>
<p>If you look at the “ArmModelStudy” object in the AnyScript window, start/end times and the
number of simulation steps (time frames) are not specified. These are actually optional parameters
when using the “AnyBodyStudy” class, which by default creates an analysis of 100 steps and spanning 1 second.</p>
<p><strong>To view the output variables of the study that was run, open the “ArmModelStudy” folder in the model tree and expand the “Output” folder.</strong></p>
<p>Since the “ArmModelStudy” contained a reference object (“Model”) pointing to the “ArmModel” folder, the “Output”
folder contains the instantaneous values of all the time varying variables (including variables in sub-folders) within “ArmModel”.</p>
<p>In “ArmModelStudy-&gt; Output-&gt; Model -&gt; Segs -&gt; ForeArm” in the <strong>model tree</strong>, you find all the nodes on the segment. Within the “HandNode”
sub-folder, you will find <code class="docutils literal"><span class="pre">r</span></code> - the position vector of the node. Clicking on <code class="docutils literal"><span class="pre">r</span></code>
shows the hand position vector (w.r.t global) for each time instant in the Information Window.</p>
</div>
<div class="section" id="plotting-simulation-results">
<h2>Plotting simulation results<a class="headerlink" href="#plotting-simulation-results" title="Permalink to this headline">¶</a></h2>
<p>Let us say, you want to plot the position vector of the hand node over the course of movement.</p>
<p>Find the variable “Main.ArmModel.Segs.ForeArm.HandNode.r” in the model tree, and click the <img alt="Chart button" src="../_images/image5b.png" /> button
found at the top of the model tree window.</p>
<p><strong>You will be prompted to choose a Chart view (Chart views 1-4) to plot the variable in. If your model has more than one study, you will also have
to choose the exact study for which you want to plot the variable vs time</strong> (Remember that two studies may use the same model,
but subject them through different motions/forces).</p>
<p>The plot should now should up in the chart view. Since position vector <code class="docutils literal"><span class="pre">r</span></code> has 3 coordinates, three curves will be shown.
Hovering your mouse over each curve shows a small label with the global name of the data, ending with coordinate indices 0,1 or 2.</p>
<p>All data computed in AnyBody can be visualized this way.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The chart view contains a filtered down version of the model tree, which only displays “AnyBodyStudy” objects. This
tree can also be used for plotting purposes.</p>
</div>
<p><img alt="Chart view HandNode" src="../_images/image61.png" /></p>
<div class="without-title admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><strong>Next lesson:</strong> This is the subject of <a class="reference internal" href="lesson5.html"><span class="doc">*Lesson 5: Definition of muscles and external forces*</span></a>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="../index.html" title="index">
          <img class="logo" src="../_static/anybody_tutorials_logo.png" alt="Logo"/>
        </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<div class="sphinx-toc sphinxglobaltoc">
<h3><a href="../contents.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Tutorial overview</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../A_Getting_started/index.html">1. Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">2. Getting started: AnyScript Programming</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="lesson1.html">Lesson 1: Basic Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="lesson2.html">Lesson 2: Defining Segments and Displaying Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="lesson3.html">Lesson 3: Connecting Segments by Joints</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Lesson 4: Imparting movement with Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="lesson5.html">Lesson 5: Definition of Muscles and External Forces</a></li>
<li class="toctree-l2"><a class="reference internal" href="lesson6.html">Lesson 6: Adding Real Bone Geometries</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../A_Getting_started_modeling/index.html">3. Getting Started with Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Interface_features/index.html">4. User interface features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../A_study_of_studies/index.html">5. A Study of Studies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Making_things_move/index.html">6. Making things move</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MuscleRecruitment/index.html">7. Inverse Dynamics of Muscle Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ForceDependentKinematics/index.html">8. Force-Dependent Kinematics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Muscle_modeling/index.html">9. Muscle Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../The_mechanical_elements/index.html">10. The Mechanical Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Advanced_script_features/index.html">11. Advanced Script Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Finite_element_analysis/index.html">12. Finite Element Analysis Interfacing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AnyExp4SOLIDWORKS/index.html">13. Making Models using SOLIDWORKS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Scaling/index.html">14. Personalizing Your Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Validation_of_models/index.html">15. Validation of Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Parameter_studies_and_optimization/index.html">16. Parameter Studies and Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Troubleshooting_anyscript/intro.html">17. Trouble Shooting AnyScript Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Posture_and_movement/intro.html">18. Posture and Movement Prediction</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../legal.html">Legal, Trademarks and Copyrights</a></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/A_Getting_started_anyscript/lesson4.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../contents.html" title="Table Of Contents"
             >toc</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="lesson5.html" title="Lesson 5: Definition of Muscles and External Forces"
             >next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="lesson3.html" title="Lesson 3: Connecting Segments by Joints"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">AnyBody Tutorials v7.1.0.dev</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" >2. Getting started: AnyScript Programming</a> &#187;</li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, AnyBody Technology.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>