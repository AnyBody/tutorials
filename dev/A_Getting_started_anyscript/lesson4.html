


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Lesson 4: Imparting movement with Drivers &#8212; AnyBody Tutorials v7.0.1.dev</title>
    <link rel="stylesheet" href="../_static/cloud.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '7.0.1.dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="../_static/cloud.base.js"></script>
    <script type="text/javascript" src="../_static/cloud.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lesson 5: Definition of Muscles and External Forces" href="lesson5.html" />
    <link rel="prev" title="Lesson 3: Connecting Segments by Joints" href="lesson3.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../contents.html" title="Table Of Contents"
             accesskey="C">toc</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="lesson5.html" title="Lesson 5: Definition of Muscles and External Forces"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="lesson3.html" title="Lesson 3: Connecting Segments by Joints"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">AnyBody Tutorials v7.0.1.dev</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Getting started: AnyScript Programming</a> &#187;</li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="lesson-4-imparting-movement-with-drivers">
<h1>Lesson 4: Imparting movement with Drivers<a class="headerlink" href="#lesson-4-imparting-movement-with-drivers" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Here’s an AnyScript file to start on if you have not completed the
previous lesson: <a class="reference download internal" href="../_downloads/demo.lesson4.any" download=""><code class="xref download docutils literal"><span class="pre">*demo.lesson4.any*</span></code></a>.</p>
</div>
<p><a class="reference internal" href="../_images/image16.png"><img alt="ModelView Arm2D initial load" src="../_images/image16.png" style="width: 245.20000000000002px; height: 232.4px;" /></a></p>
<p>If you have completed the three previous lessons, you should have a
model with an upper arm grounded at the shoulder joint and connected to
a forearm by the elbow. What we want to do now is to make the arm move.</p>
<p>How can an arm with no muscles move? Well, in reality, it cannot, but in
what we are about to do here, the movement comes first, and the muscle
forces afterward. <strong>This technique is known as inverse dynamics.</strong> We
shall get to the muscles in the next lesson and stick to the movement in
this one.</p>
<div class="section" id="what-are-drivers">
<h2>What are drivers?<a class="headerlink" href="#what-are-drivers" title="Permalink to this headline">¶</a></h2>
<p>Our mechanism has two degrees of freedom because it can rotate at the
shoulder and at the elbow. This means that we have to specify two
drivers. The natural way is to drive the shoulder and elbow rotations
directly, and this is in fact what we shall do. But we could also choose
any other two measures as long as they uniquely determine the position
of all the segments in the mechanism. If you were building this model
for some ergonomic investigation, you might want to drive the end point
of the forearm where the wrist should be located in x and&nbsp;y coordinates
to simulate the operation of some handles or controls. And this would be
just as valid a model because the end point position uniquely determines
the elbow and shoulder rotations.</p>
</div>
<div class="section" id="creating-an-anykineqsimple-driver">
<h2>Creating an AnyKinEqSimple driver<a class="headerlink" href="#creating-an-anykineqsimple-driver" title="Permalink to this headline">¶</a></h2>
<p>For now, let’s make a new folder and define two drivers:</p>
<div class="highlight-AnyScriptDoc"><div class="highlight"><pre><span></span><span class="p">};</span> <span class="c1">// Jnts folder</span>

<span class="gr">AnyFolder Drivers = {</span>
<span class="gr">  //---------------------------------</span>
<span class="gr">  AnyKinEqSimpleDriver ShoulderMotion = {</span>
<span class="gr">    AnyRevoluteJoint &amp;Jnt = ..Jnts.Shoulder;</span>
<span class="gr">    DriverPos = {-100*pi/180};</span>
<span class="gr">    DriverVel = {30*pi/180};</span>
<span class="gr">  }; // Shoulder driver</span>
<span class="gr">  //---------------------------------</span>
<span class="gr">  AnyKinEqSimpleDriver ElbowMotion = {</span>
<span class="gr">    AnyRevoluteJoint &amp;Jnt = ..Jnts.Elbow;</span>
<span class="gr">    DriverPos = {90*pi/180};</span>
<span class="gr">    DriverVel = {45*pi/180};</span>
<span class="gr">  }; // Elbow driver</span>
<span class="gr">}; // Driver folder</span>
</pre></div>
</div>
<p>This is much like what we have seen before. The folder contains two
objects: ShoulderMotion and ElbowMotion. Each of these is of class
AnyKinEqSimpleDriver. A driver is really nothing but a mathematical
function of time. The AnyKinEqSimpleDriver is particularly simple in
that starts at some position at time = 0 and increases or decreases at a
constant velocity from there. These two drivers are attached to joints,
and therefore they drive joint rotations. But the same driver class
could also be used to drive translations, for instance the cartesian
position of a point.</p>
<p>The lines</p>
<div class="highlight-AnyScriptDoc"><div class="highlight"><pre><span></span><span class="kt">AnyRevoluteJoint</span> <span class="o">&amp;</span><span class="n">Jnt</span> <span class="o">=</span> <span class="p">..</span><span class="n">Jnts</span><span class="p">.</span><span class="n">Shoulder</span><span class="p">;</span>
</pre></div>
</div>
<p>and</p>
<div class="highlight-AnyScriptDoc"><div class="highlight"><pre><span></span><span class="kt">AnyRevoluteJoint</span> <span class="o">&amp;</span><span class="n">Jnt</span> <span class="o">=</span> <span class="p">..</span><span class="n">Jnts</span><span class="p">.</span><span class="n">Elbow</span><span class="p">;</span>
</pre></div>
</div>
<p>are the ones that affiliate the two drivers with the shoulder and elbow
joints respectively. They are constructed the same way as the joint
definition in <a class="reference internal" href="lesson3.html"><span class="doc">*Lesson 3*</span></a> in the sense that a local
variable, Jnt, is declared and can be used instead of the longer global
name if we need to reference the joint somewhere else inside the driver.
Notice also the use of the reference operator ‘&amp;’ that causes the local
variable to be a pointer to the global one rather than a copy. It means
that if some property of the globally defined joint changes, then the
local version changes with it.</p>
<p>The specifications of DriverPos and DriverVel are&nbsp;the starting value of
the driver and the constant velocity, respectively.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since these drivers drive angles, the units are radians and
radians/sec.</p>
</div>
<p>Try loading the model again by hitting F7. If you did not mistype
anything, you should get the message “Loaded successfully” and no
warning messages about lacking kinematic constraints this time.</p>
</div>
<div class="section" id="running-simulations-making-things-move">
<h2>Running simulations - making things move!<a class="headerlink" href="#running-simulations-making-things-move" title="Permalink to this headline">¶</a></h2>
<p>This is good news because you are now actually ready to see the model
move. If you look closer at the model tree window, it has a second tab
labelled “Operations”. This is the place where the AnyBody system places
your studies, and from this window, you can execute them, i.e., start
analyses and calculations.</p>
<p><a class="reference internal" href="../_images/image24.png"><img alt="Operations ArmStudy" src="../_images/image24.png" style="width: 227.20000000000002px; height: 336.0px;" /></a></p>
<p>Try expanding the ArmStudy root. You will get&nbsp;a list of the study types
that the system can perform. “Study” is a common name for operations you
can perform on a model. Try clicking the KinematicAnalysis study. With
the buttons in the Operations window, you can now execute various types
of analysis.</p>
<p>The Execute toolbar above the operations tree contains three buttons
<a class="reference internal" href="../_images/image33.png"><img alt="Model tree toolbar Execute buttons" src="../_images/image33.png" style="width: 93.60000000000001px; height: 20.0px;" /></a>:</p>
<ul class="simple">
<li><strong>Run operation</strong>: Starts or pauses the chosen operation. Shortcut
F5.</li>
<li><strong>Step operation</strong>: Advances to next step of operation, typically a
time step. Shortcut F6.</li>
<li><strong>Stop operation</strong>: Sets the operation back to its initial position.
You must reset before you start a new analysis that was previously
aborted. Shortcut F4</li>
</ul>
</div>
<div class="section" id="replaying-a-simulation">
<h2>Replaying a simulation<a class="headerlink" href="#replaying-a-simulation" title="Permalink to this headline">¶</a></h2>
<p>All these functions are also available from the main frame toolbar
<a class="reference internal" href="../_images/image43.png"><img alt="Execute toolbar" src="../_images/image43.png" style="width: 126.4px; height: 21.6px;" /></a> and the menu Operation.</p>
<p>Now, try your luck with the <strong>KinematicAnalysis</strong> study and the Run
button. What should happen is that the model starts to move as the
system runs through 101 timesteps of the study.</p>
<p>When the analysis in finished, you can use the replay panel to replay
the model as you do in a movie player.</p>
<p><a class="reference internal" href="../_images/image53.png"><img alt="Replay toolbar" src="../_images/image53.png" style="width: 782.4000000000001px; height: 24.0px;" /></a></p>
<p>Since we have no muscles so far, kinematic analysis is really all that
makes sense. A kinematic analysis is pure motion. The model moves, and
you can subsequently investigate positions, velocities, and
accelerations. But no force, power, energy or other such things are
computed. These properties are calculated by the
<strong>InverseDynamicAnalysis</strong>.</p>
</div>
<div class="section" id="fetching-simulation-results">
<h2>Fetching simulation results<a class="headerlink" href="#fetching-simulation-results" title="Permalink to this headline">¶</a></h2>
<p>The analysis has 101 time steps corresponding to a division of the total
analysis time into 100 equal pieces. The total time span simulated in
the analysis is 1 sec. These are default values because we did not
specify them when we defined the ArmModelStudy in the AnyScript model.
If you want more or fewer time steps or a longer or shorter analysis
interval, all you have to do is to set the corresponding property in the
ArmModelStudy definition. When you click “Run”, all the time steps are
executed in sequence, and the mechanism animates in the graphics window.</p>
<p>So far, the model was merely a two-bar mechanism moving at constant
joint angular velocities. However, the system has actually computed
information that might be interesting to investigate. <strong>All the analysis
results are available in the ArmModelStudy branch of the tree view</strong>.</p>
<p>Directly under the ArmModelStudy branch, you find the <strong>Output branch</strong>
where all computed results are stored. Notice that the Output branch
contains the same folders we defined in the AnyScript model: GlobalRef,
Segs, and so on. In the Segs folder you find ForeArm, and in that a
branch for each of the nodes we defined on the arm. Try expanding the
branch for the HandNode. It contains the field ‘r’ which is the position
vector of the node. We might want to know the precise position of the
HandNode at each time in the analysis, for instance, if we were doing an
ergonomic study and wanted to know if the hand had collided with
anything on its way.</p>
<p>If you double-click the ‘r’ node, the instantaneous position vector
(depending on where your replay slider is) of the hand node for each
time step is dumped in the message window at the bottom of the screen.</p>
</div>
<div class="section" id="plotting-simulation-results">
<h2>Plotting simulation results<a class="headerlink" href="#plotting-simulation-results" title="Permalink to this headline">¶</a></h2>
<p>However, we often prefer to plot our results. With the default layout,
this feature is located in the same window as Model View under the tab
called “Chart 1”. You can also open it from the pull-down menus by
choosing View -&gt; Charts -&gt; …</p>
<p>This gives you a new window structured just like the editor window with
a tree view to the left, but with an empty field for graphing results.</p>
<p>The tree in this window is much like the tree in the editor window
except that some of the data has been filtered out so that you mainly
see the parts of the tree that are relevant in terms of results or
output. You can expand the tree in the chart window through ArmStudy and
Output until you come to the HandNode. When you pick the property ‘r’,
you get three curves corresponding to the movement of the three
Cartesian coordinates of this node during the simulated time period. Try
holding the mouse pointer over one of the curves for a moment. A small
label with the global name of the data of the curve appears. All data
computed in AnyBody can be visualized this way.</p>
<p><img alt="Chart view HandNode" src="../_images/image61.png" /></p>
<p>So far, we have only the kinematic data to look at. Before we can start
the real biomechanics, we must add some muscles to the model.</p>
<div class="without-title admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><strong>Next lesson:</strong> This is the subject of <a class="reference internal" href="lesson5.html"><span class="doc">*Lesson 5: Definition of muscles and external forces*</span></a>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="../index.html" title="index">
          <img class="logo" src="../_static/anybody_tutorials_logo.png" alt="Logo"/>
        </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<div class="sphinx-toc sphinxglobaltoc">
<h3><a href="../contents.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Tutorial overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../A_Getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Getting started: AnyScript Programming</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="lesson1.html">Lesson 1: Basic Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="lesson2.html">Lesson 2: Defining Segments and Displaying Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="lesson3.html">Lesson 3: Connecting Segments by Joints</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Lesson 4: Imparting movement with Drivers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-are-drivers">What are drivers?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-an-anykineqsimple-driver">Creating an AnyKinEqSimple driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-simulations-making-things-move">Running simulations - making things move!</a></li>
<li class="toctree-l3"><a class="reference internal" href="#replaying-a-simulation">Replaying a simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fetching-simulation-results">Fetching simulation results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plotting-simulation-results">Plotting simulation results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lesson5.html">Lesson 5: Definition of Muscles and External Forces</a></li>
<li class="toctree-l2"><a class="reference internal" href="lesson6.html">Lesson 6: Adding Real Bone Geometries</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../A_Getting_started_modeling/index.html">Getting Started with Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Interface_features/index.html">User interface features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../A_study_of_studies/index.html">A Study of Studies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Making_things_move/index.html">Making things move</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MuscleRecruitment/index.html">Inverse Dynamics of Muscle Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ForceDependentKinematics/index.html">Force-Dependent Kinematics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Muscle_modeling/index.html">Muscle Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../The_mechanical_elements/index.html">The Mechanical Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Advanced_script_features/index.html">Advanced Script Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Finite_element_analysis/index.html">Finite Element Analysis Interfacing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AnyExp4SOLIDWORKS/index.html">Making Models using SOLIDWORKS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Scaling/index.html">Subject Specific Scaling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Validation_of_models/index.html">Validation of Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Parameter_studies_and_optimization/index.html">Parameter Studies and Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Troubleshooting_anyscript/intro.html">Trouble Shooting AnyScript Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Posture_and_movement/intro.html">Posture and Movement Prediction</a></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/A_Getting_started_anyscript/lesson4.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../contents.html" title="Table Of Contents"
             >toc</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="lesson5.html" title="Lesson 5: Definition of Muscles and External Forces"
             >next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="lesson3.html" title="Lesson 3: Connecting Segments by Joints"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">AnyBody Tutorials v7.0.1.dev</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" >Getting started: AnyScript Programming</a> &#187;</li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, AnyBody Technology.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.4.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>