


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Lesson 5: Muscle Models &#8212; AnyBody Tutorials v7.0.1.dev</title>
    <link rel="stylesheet" href="../_static/cloud.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '7.0.1.dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="../_static/cloud.base.js"></script>
    <script type="text/javascript" src="../_static/cloud.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lesson 6: General Muscles" href="lesson6.html" />
    <link rel="prev" title="Lesson 4: Wrapping Muscles" href="lesson4.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../contents.html" title="Table Of Contents"
             accesskey="C">toc</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="lesson6.html" title="Lesson 6: General Muscles"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="lesson4.html" title="Lesson 4: Wrapping Muscles"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">AnyBody Tutorials v7.0.1.dev</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Muscle Modeling</a> &#187;</li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="lesson-5-muscle-models">
<h1>Lesson 5: Muscle Models<a class="headerlink" href="#lesson-5-muscle-models" title="Permalink to this headline">¶</a></h1>
<p>Muscle model is a description of how a muscle behaves under different
operating conditions. There are two schools of thought within this area.</p>
<ul class="simple">
<li>The first school pursues phenomenological models based on
the&nbsp;classical&nbsp;work by <em>A.V. Hill</em>. These models are usually based on
a description of a muscle as a contractile element in combination
with a number of elastic elements. While these models&nbsp;make no attempt
to directly model the microscopic mechanisms of muscle contraction,
they do reproduce many properties of muscle behavior quite well, and
most models of this class can be implemented with great numerical
efficiency.</li>
<li>The second school attempts to directly model the microscopic physical
phenomena of cross bridge activity in muscle contraction. The origin
of these models is usually attributed to <em>A.F. Huxley</em>, and they lead
to differential equations and consequently to much more
computationally demanding models.</li>
</ul>
<p>The AnyBody Modeling System requires muscle models because it must take
the strength of different muscles into account when distributing the
load over them. A traditional muscle model is one that takes an
activation signal and a present muscle state as input and produces a
force as output.&nbsp;But inverse dynamics, as it is used in the AnyBody
Modeling System, does not work quite like that. Instead of taking an
activation signal as input, AnyBody produces the muscle active state as
output. This means that typical muscle models from the literature must
be mathematically reversed before they can be used in the AnyBody
Modeling System. Depending on the complexity of the muscle model, this
may be more or less difficult.</p>
<p>AnyBody has three muscle models available differing in complexity and
accuracy of their representation of physiological muscles. All of these
are phenomenological, i.e. they make no attempt to capture the
complexity of cross bridge dynamics. You may ask why we would want three
different models? Why don’t we just use the better of the three models?
The answer is that accurate models are good, but they are never more
accurate than the input data, and it is often difficult to find the
detailed physiological data that the complex models require. Instead of
basing&nbsp;a computation on data of unknown accuracy it is often preferable
to go with a simpler model where the approximations are clear.</p>
<p>In short, AnyBody has the following muscle models available</p>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="96%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">AnyMuscleModel</th>
<th class="head"><p class="first">This is the simplest conceivable muscle model, and it is the one we have used in the preceding lessons of this tutorial. The only input to the model is the muscle’s presumed isometric strength, F0, i.e. the force that the muscle can exert in a static condition at its optimum length. F0 is often believed to be proportional to the physiological cross sectional area of the muscle, and it is possible to find that dimension for most significant muscles in the human body from cadaver studies reported in the scientific literature.</p>
<p class="last">It is important to stress that the strength of this muscle model is independent of the muscle’s current length and contraction velocity. It is known for a fact that muscles do not behave that way, but for models with moderate contraction velocities and small joint angle variations even this simple model will work reasonably well. Such has been shown to be case for bicycling and gait.</p>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>AnyMuscleModel2ELin</td>
<td><p class="first">This model presumes that the muscle strength is proportional to the current length and to the contraction velocity. This means that the muscle gets weaker when its length decreases or the contraction velocity increases. In other words, the muscle strength is bilinear in the length and velocity space. The model also presumes that the tendon is linearly elastic and as such contains two elements: A contractile element (the muscle), and a serial-elastic element (the tendon).</p>
<p class="last">The rationale behind this model is that a muscle has a certain passive elasticity built into it. If the muscle it stretched far enough, the passive elasticity will build up force and reduce the necessity for active muscle force. This is in some cases equivalent to an increase of the muscle’s strength. Notice, however, that this model has the significant drawback that the force can be switched off even if the muscle is stretched very far, while the true passive elasticity will always provide a force when it is stretched.</p>
</td>
</tr>
<tr class="row-odd"><td>AnyMuscleModel3E</td>
<td>This is a full-blown Hill model that takes parallel passive elasticity of the muscle, serial elasticity of the tendon, pennation angle of the fibers, and many other properties into account. However, it also requires several physiological parameters that may be difficult to get or estimate for a particular muscle in a particular individual.</td>
</tr>
</tbody>
</table>
<p>In the reminder of this lesson we shall experiment with the consequences
of the different muscle models. The AnyScript model from the previous
lesson will suffice very nicely. You can download a functional version
of the model here:</p>
<p><a class="reference download internal" href="../_downloads/MuscleDemo.5.any" download=""><code class="xref download docutils literal"><span class="pre">MuscleDemo.5.any</span></code></a></p>
<div class="section" id="anymusclemodel2elin">
<h2>AnyMuscleModel2ELin<a class="headerlink" href="#anymusclemodel2elin" title="Permalink to this headline">¶</a></h2>
<p>Right-click and save the file to your local disk, and subsequently open
the model in&nbsp;the AnyBody Modeling System. &nbsp;We have already seen the
consequences of using the simple muscle model, so we shall proceed
directly to the two-element muscle, the AnyMuscleModel2ELin.&nbsp;Let us
define such a muscle model. If you click the Classes tab in the tree
view left of the edit window, expand the class tree, right-click the
AnyMuscleModel2ELin class, and insert a template, you will obtain the
following:</p>
<div class="highlight-AnyScriptDoc"><div class="highlight"><pre><span></span> <span class="kt">AnyMuscleModel</span> <span class="n">SimpleModel</span> <span class="o">=</span> <span class="p">{</span>
   <span class="n">F0</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
 <span class="p">};</span>

<span class="gr">AnyMuscleModel2ELin &lt;ObjectName&gt; = {</span>
<span class="gr">   F0 = 0;</span>
<span class="gr">   Lfbar = 0;</span>
<span class="gr">   Lt0 = 0;</span>
<span class="gr">   Epsilonbar = 0;</span>
<span class="gr">   V0 = 0;</span>
<span class="gr"> };</span>
</pre></div>
</div>
<p>Let us briefly review the parameters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="3%" />
<col width="97%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Function</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>F0</td>
<td>In the simple muscle model, F0 is simply the strength of the muscle. In this two-parameter model, F0 is the ideal strength, i.e. the strength of the muscle at neutral fiber length and zero contraction velocity. F0 is measured in force units, i.e. Newton.</td>
</tr>
<tr class="row-odd"><td>Lfbar</td>
<td>The neutral fiber length, i.e. the length of the contractile element at which the muscle has the strength of F0. Lfbar is measured in length units, i.e. meters.</td>
</tr>
<tr class="row-even"><td>Lt0</td>
<td>The muscle’s total length from origin to insertion can be divided into two parts: the length of the muscle’s contractile element plus the length of the tendon. The tendon is considered in this model to be linearly elastic, and Lt0 is the slack length of the tendon, i.e. the length when it is taut but carrying no force. Lt0&nbsp;is measured in length units, i.e. meters.</td>
</tr>
<tr class="row-odd"><td>Epsilonbar</td>
<td>This parameter controls the elasticity of the tendon. The physical interpretation is that it is the tendon’s strain when subjected to a force of F0. Prescribing a strain rather than an ordinary spring stiffness is based on the idea that the tendon thickness&nbsp;must be&nbsp;related to the strength of the muscle: strong muscles need strong tendons. Hence, Epsilonbar can be presumed with good accuracy to be the same for a wide variety of very different muscles. Epsilonbar is measures in fractions and is therefore dimensionless.</td>
</tr>
<tr class="row-even"><td>V0</td>
<td>This model presumes that the muscle’s strength depends linearly on its contraction velocity. V0 is measured in absolute velocity, i.e. m/s.</td>
</tr>
</tbody>
</table>
<p>We can study the significance of the parameters in more detail, if we
formulate the strength mathematically:</p>
<p><img alt="http://www.anybodytech.com/fileadmin/AnyBody.3.x.x/tutorial/MuscleModeling/twoparstrength.gif" src="../_images/image136.png" /></p>
<p>You can probably recognize the variable names in the table above from
the symbols in the equation. As you can see, this is really a bilinear
model, where the variables are Lm and Lmdot. The strength of the muscle
vanishes is any of the two parentheses becomes zero. This can happen if
either Lm, i.e. the current length of the contractile element, becomes
half the length of Lfbar, or if Lmdot becomes equal to V0. Please notice
that Lmdot is negative when a muscle is contracting, so meaningful
values of V0 must also be negative. The system automatically truncates
negative values of the strength expression to zero.</p>
<p>In a few moments, when we start playing around with the muscle model in
AnyBody, you wll recognize these properties in the available muscle
variables in the Chart View.</p>
<p>Let us assign a name and some reasonable parameters to our two-element
muscle model:</p>
<div class="highlight-AnyScriptDoc"><div class="highlight"><pre><span></span><span class="kt">AnyMuscleModel2ELin</span> <span class="gr">Model2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">F0</span> <span class="o">=</span> <span class="gr">200</span><span class="p">;</span>
   <span class="n">Lfbar</span> <span class="o">=</span> <span class="gr">0.3</span><span class="p">;</span>
   <span class="n">Lt0</span> <span class="o">=</span> <span class="gr">0.5</span><span class="p">;</span>
   <span class="n">Epsilonbar</span> <span class="o">=</span> <span class="gr">0.05</span><span class="p">;</span>
   <span class="n">V0</span> <span class="o">=</span> <span class="gr">-8.0</span><span class="p">;</span>
 <span class="p">};</span>
</pre></div>
</div>
<p>The parameters here are more or less random. In a moment we
shall&nbsp;explain the ones that are less random, but first we must assign
the new model to Muscle1:</p>
<div class="highlight-AnyScriptDoc"><div class="highlight"><pre><span></span><span class="kt">AnyShortestPathMuscle</span> <span class="n">Muscle1</span> <span class="o">=</span> <span class="p">{</span>
  <span class="kt">AnyMuscleModel</span> <span class="o">&amp;</span><span class="n">Model</span> <span class="o">=</span> <span class="gr">.Model2</span><span class="p">;</span>
  <span class="kt">AnyRefFrame</span> <span class="o">&amp;</span><span class="n">Orig</span> <span class="o">=</span> <span class="p">.</span><span class="n">GlobalRef</span><span class="p">.</span><span class="n">M1Origin</span><span class="p">;</span>
  <span class="kt">AnyRefFrame</span> <span class="o">&amp;</span><span class="n">Via</span> <span class="o">=</span> <span class="p">.</span><span class="n">Arm</span><span class="p">.</span><span class="n">ViaPoint</span><span class="p">;</span>
  <span class="kt">AnySurface</span> <span class="o">&amp;</span><span class="n">srf</span> <span class="o">=</span> <span class="p">.</span><span class="n">GlobalRef</span><span class="p">.</span><span class="n">CylCenter</span><span class="p">.</span><span class="n">WrapSurf</span><span class="p">;</span>
  <span class="kt">AnyRefFrame</span> <span class="o">&amp;</span><span class="n">Ins</span> <span class="o">=</span> <span class="p">.</span><span class="n">Arm</span><span class="p">.</span><span class="n">M1Insertion</span><span class="p">;</span>
  <span class="n">SPLine</span><span class="p">.</span><span class="n">StringMesh</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
  <span class="kt">AnyDrawMuscle</span> <span class="n">drw</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">Bulging</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">ColorScale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">MaxStress</span> <span class="o">=</span> <span class="mi">250000</span><span class="p">;</span>
  <span class="p">};</span>
<span class="p">};</span>
</pre></div>
</div>
<p>We are ready to run the analysis again and investigate the results. Pick
the InverseDynamicAnalysis in the tree of operations and click the Run
button. Then open a new Chart View and expand the tree in the Chart View
as far down as Muscle1. You will see a whole list of muscle properties
that you can chart simply by clicking them. Let us initially see how the
properties Lm and Lmdot affecting the strength of the model. You can
plot several properties simultaneously in the Chart View by use of an
asterix in the variable specification field at the top of the window
like this:</p>
<p><img alt="chart view: muscle1.L" src="../_images/image230.png" /></p>
<p>Now we can compare the variation of Lm and Lmdot to our settings of
Lfbar and V0. Lm seems to vary between approximately 0.31 and 0.15. With
an Lfbar of 0.3 (= 2x0.15) this means that the muscle must come close to
the minimum length at which is has any strength when we approach the end
of the movement. Lmdot varies between -0.24 and -0.06, and this is far
from its speed limit&nbsp;V0 =&nbsp;-8, so the contraction speed is not expected
to have much effect. We can investigate the effect very easily simply by
clicking the Strength property of the muscle and obtain the following
graph:</p>
<p><img alt="muscle strength plot" src="../_images/image329.png" /></p>
<p>The strength does indeed decrease&nbsp;drastically from around 200 N to
almost nothing as we expected when the muscle contracts.</p>
<p>Now that we have muscle data available, let us briefly review the
parameters presented in the Chart View:</p>
<p><img alt="Muscle parameters" src="../_images/image421.png" /></p>
<ul class="simple">
<li><strong>Fin</strong>&nbsp;is a force, but it has not physiological significance for a
muscle except for internal purposes. The reason why it is included in
the output is that it is inherited from the AnyScript classes that a
muscle is derived from.</li>
<li><strong>Fout</strong> is a force, but it has not physiological significance for a
muscle except for internal purposes. The reason why it is included in
the output is that it is inherited from the AnyScript classes that a
muscle is derived from.</li>
<li><strong>Lmt</strong> is the total length of the muscle-tendon unit, i.e. the
origin-insertion length.</li>
<li><strong>Lm</strong> is the length of the muscle’s contractile element.</li>
<li><strong>Lt</strong> is the length of the tendon. This is not necessarily the same
as Lt0 because the tendon is linearly elastic and therefore stretches
slightly with the force.</li>
<li><strong>LmtDot</strong> is the rate of change of Lmt, i.e. the length change
velocity of the total muscle-tendon unit.</li>
<li><strong>LmDot</strong> is the contraction velocity of the contractile element.</li>
<li><strong>Activity</strong> is the muscle active state in fractions of maxmum
voluntary contraction.</li>
<li><strong>CorrectedActivity</strong> for this muscle&nbsp;model is the same as Activity.</li>
<li><strong>Fm</strong> is the force in the muscle’s contractile element. For this
muscle type it is equal to the total force in the muscle-tendon unit
because the muscle does not have any parallel components.</li>
<li><strong>Ft</strong> is the force in the tendon. For this muscle model it is the
same as Fm.</li>
<li><strong>Fp</strong> is not relevant for this type of muscle model.</li>
<li><strong>Strength</strong> is the muscle’s strength at each moment of the movement.</li>
<li><strong>Ft0</strong> is not relevant for this type of muscle model.</li>
<li><strong>Ft0Grad</strong> is the derivative of tendon force with respect to active
state. For this muscle model is amounts to exactly the same as the
Strength variable, but for muscles with parallel elasticity the two
properties will be different.</li>
<li><strong>PennationAngle</strong> is not relevant for this muscle model type.</li>
<li><strong>EPOTt</strong> is the potential elastic energy in the tendon.</li>
<li><strong>EPOTp</strong> is the potential elastic energy in the parallel-elastic
element, which is not included in this muscle model.</li>
<li><strong>EPOTmt</strong> is the total elastic potential energy in the muscle-tendon
unit.</li>
<li><strong>Pt</strong> is not relevant for this muscle model.</li>
<li><strong>Pm</strong> is the mechanical power exerted by the muscle’s contractile
element.</li>
<li><strong>Pmt</strong> is the mechanical power of the muscle-tendon unit on the
skeleton.</li>
<li><strong>Pmet</strong> is a crude estimate of the metabolic power consumption of
the muscle taking different efficiencies for concentric and eccentric
work into account.</li>
</ul>
<p>We have seen how the length of the muscle affects its strength, but what
about the velocity? Well, the specified values of -8 m/s is a reasonable
estimate for many physiological muscles, but let us try to decrease it
and thereby make the muscle more sensitive to contraction velocity:</p>
<div class="highlight-AnyScriptDoc"><div class="highlight"><pre><span></span><span class="kt">AnyMuscleModel2ELin</span> <span class="n">Model2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">F0</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
   <span class="n">Lfbar</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span>
   <span class="n">Lt0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
   <span class="n">Epsilonbar</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">;</span>
  <span class="gr">V0 = -0.3</span><span class="p">;</span>
 <span class="p">};</span>
</pre></div>
</div>
<p>A value&nbsp;of V0 = -0.3 is close to the contraction velocity of the muscle
in the beginning of the simulation. This, this decreases the strength of
the muscle significantly as we can see by reloading, rerunning and
plotting the Strength variable again:</p>
<p><img alt="muscle strength plot, v0=-0.3" src="../_images/image517.png" /></p>
<p>Instead of being monotonically decreasing, the muscle strength now
improves slightly in the initial part of the simulation, but it is all
through the simulation significantly weaker than before. The initial
increase is due to the beneficial effect of the decreasing contraction
velocity, so this muscle model in spite of its simplicity is capable of
balancing several of the effects of real muscle physiology.</p>
<p>Another of the important input parameters in this example is the nominal
tendon length, Lt0. This is a parameter that has a very large influence
on the muscle’s performance. The total origin-insertion length of the
muscle-tendon unit depends on the size and posture of the body. The
muscle spans this length with the sum of muscle length, Lm, and tendon
length, Lt, such that Lmt = Lm + Lt. Both Lm and Lt change during the
movement of the body. Lt is given by its initial length, Lt0, and the
elastic deformation. Lm has to take up whatever&nbsp;rest of&nbsp;Lmt that is
available after Lt has been subtracted. In some cases, the tendon is
significantly longer than the muscle, and this means that a relatively
small variation of the tendon length results in a large relative
variation of the portion of Lmt that the muscle has to fill. Obviously
Lt0 plays a significant role for Lt and hence influences the working
length of the muscle. Let us investigate this effect by reducing Lt0:</p>
<div class="highlight-AnyScriptDoc"><div class="highlight"><pre><span></span><span class="kt">AnyMuscleModel2ELin</span> <span class="n">Model2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">F0</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
   <span class="n">Lfbar</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span>
   <span class="n">Lt0</span> <span class="o">=</span> <span class="gr">0.3</span><span class="p">;</span>
   <span class="n">Epsilonbar</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">;</span>
   <span class="n">V0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">;</span>
 <span class="p">};</span>
</pre></div>
</div>
<p>This reduction of the tendon length from 0.5 to 0.3 meters is very
significant compared to the nominal muscle fiber length of Lfbar = 0.3
m. Reducing the length of the tendon increases the length and thereby
the strength of the muscle:</p>
<p><img alt="muscle strength plot, Lt0= 0.3" src="../_images/image69.png" /></p>
<p>The interdependency between the stretch of the tendon, the length of the
muscle, and the strength of the muscle is the origin of another
approximation in the model: The system computes the changed length of
the muscle due to the stretching of the tendon, but this length change
is not taken into account in the computation of the muscle strength.
Nevertheless, let us investigate how the stretch of the tendon
influences the muscle. We shall define an external load on the arm,
which causes the tendon to stretch. But before we change anything, let
us just notice that the variation of muscle length, Lm, over the
movement in the absence of an external load is as shown below:</p>
<p><img alt="Lm plot, no external load" src="../_images/image76.png" /></p>
<p>Definition of an external force requires two new elements in the model:
The force itself and a new node on the arm, which we shall call hand, to
which the load can be applied:</p>
<div class="highlight-AnyScriptDoc"><div class="highlight"><pre><span></span> <span class="c1">// Define one simple segment</span>
 <span class="kt">AnySeg</span> <span class="n">Arm</span> <span class="o">=</span> <span class="p">{</span>
   <span class="n">r</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.000000</span><span class="p">,</span> <span class="mf">0.000000</span><span class="p">};</span>
   <span class="n">Mass</span> <span class="o">=</span> <span class="mf">1.000000</span><span class="p">;</span>
   <span class="n">Jii</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.100000</span><span class="p">,</span> <span class="mf">1.000000</span><span class="p">,</span> <span class="mf">1.000000</span><span class="p">}</span><span class="o">*</span><span class="mf">0.1</span><span class="p">;</span>
   <span class="kt">AnyRefNode</span> <span class="n">Jnt</span> <span class="o">=</span> <span class="p">{</span>
     <span class="n">sRel</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>
   <span class="p">};</span>
   <span class="kt">AnyRefNode</span> <span class="n">M1Insertion</span> <span class="o">=</span> <span class="p">{</span>
     <span class="n">sRel</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>
   <span class="p">};</span>
   <span class="kt">AnyRefNode</span> <span class="n">M2Insertion</span> <span class="o">=</span> <span class="p">{</span>
     <span class="n">sRel</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">};</span>
   <span class="p">};</span>
   <span class="kt">AnyRefNode</span> <span class="n">ViaPoint</span> <span class="o">=</span> <span class="p">{</span>
     <span class="n">sRel</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>
   <span class="p">};</span>
   <span class="gr">AnyRefNode Hand = {</span>
<span class="gr">     sRel = {0.5, 0.0, 0};</span>
<span class="gr">   };</span>
   <span class="kt">AnyDrawSeg</span> <span class="n">drw</span> <span class="o">=</span> <span class="p">{};</span>
 <span class="p">};</span>
<span class="gr">AnyForce3D Load = {</span>
<span class="gr">   AnyRefNode &amp;Attachment = .Arm.Hand;</span>
<span class="gr">   F = {-100, -100, 0};</span>
<span class="gr"> };</span>
</pre></div>
</div>
<p>The load is pointing down and backward at a 45 degree angle, so that it
changes its moment arm from positive to negative a shortly after the
midpoint of the analysis. This causes the muscle length to vary in the
following fashion:</p>
<p><img alt="Muscle length plot" src="../_images/image84.png" /></p>
<p>The interesting point here is that with the long tendon and the high
load, the muscle no longer contracts uniformly. In fact, the muscle
extends for much of the movement due to the decreasing load which causes
the elastic tendon to contract instead.</p>
<p>While the two-parameter muscle model captures many of the properties of
real muscles it also fails to reflect important parts of muscle
physiology, so it should be applied with care. In particular it does not
model passive elasticity. The following section presents a full-blown
Hill-type model, which does not have these shortcomings.</p>
</div>
<div class="section" id="anymusclemodel3e">
<h2>AnyMuscleModel3E<a class="headerlink" href="#anymusclemodel3e" title="Permalink to this headline">¶</a></h2>
<p>So far we have been focusing our attention on Muscle1 in the demo model
and left Muscle2 with the simple muscle model. Let us briefly study what
Muscle2 is actually doing (if you need an updated&nbsp;working model, you can
download it here:
<a class="reference download internal" href="../_downloads/MuscleDemo.5-2.any" download=""><code class="xref download docutils literal"><span class="pre">*MuscleDemo.5-2.any*</span></code></a>. Muscle2 wraps
about the cylinder and obviously extends significantly&nbsp;as the arm&nbsp;turns
upward. If you run the analysis and plot the length of Muscle2, you will
see that it increases 0.7 to 1 meter. For a normal muscle (actually&nbsp;a
muscle of this size&nbsp;would probably be found in a giraffe) a stretching
of that magnitude would almost certainly&nbsp;lead to some passive force in
the muscle.</p>
<p>Passive force is&nbsp;what comes from the structural integrity&nbsp;of the muscle.
If we disregard the active properties of the muscle and think of it as
simply a piece of material that we can stretch, then the material will
provide a passive resistance depending on how far we stretch it. This is
the passive component of the muscle force. We can easily find passive
muscle force in our own bodies: When we bend forward and try to touch
our toes with the straight legs, then most of us will feel the
hamstrings getting very taut. This is passive elasticity. The
two-element muscle model of the preceding section handles the presence
of this elasticity by increasing the strength of the muscle, and this
works fine if the muscle is supposed to be active in the sense that the
model in such a state would predict a high force with a low muscle
activity. But the passive muscle force cannot be switched off, so it
will still be present even if it is disadvantageous, and the two-element
model will not predict this.</p>
<p>The AnyMuscleModel3E is a full-blown Hill-type muscle model that does
not suffer from this deficiency. It is called a three-element model
because it has the following components:</p>
<ol class="arabic simple">
<li>A contractile element (CE) representing the active properties of the
muscle fibers.</li>
<li>A serial-elastic (T) element representing the elasticity of the
tendon.</li>
<li>A parallel-elastic element (PE) representing the passive stiffness of
the muscle fibers.</li>
</ol>
<p><img alt="muscle model" src="../_images/image92.png" /></p>
<p>The figure above is a schematic representation of the muscle model. We
can get a complete impression of the parameters of the model if we pick
the model from the Class List as we have done before and insert a
template into our AnyScript model:</p>
<div class="highlight-AnyScriptDoc"><div class="highlight"><pre><span></span><span class="kt">AnyMuscleModel2ELin</span> <span class="n">Model2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">F0</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
    <span class="n">Lfbar</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span>
    <span class="n">Lt0</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span>
    <span class="n">Epsilonbar</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">;</span>
    <span class="n">V0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">;</span>
 <span class="p">};</span>

<span class="gr">AnyMuscleModel3E &lt;ObjectName&gt; = {</span>
<span class="gr">    F0 = 0;</span>
<span class="gr">    Lfbar = 0;</span>
<span class="gr">    Gammabar = 0;</span>
<span class="gr">    Epsilonbar = 0;</span>
<span class="gr">    Lt0 = 0;</span>
<span class="gr">    Fcfast = 0;</span>
<span class="gr">    //Jt = 3;</span>
<span class="gr">    //Jpe = 3;</span>
<span class="gr">    //K1 = 2;</span>
<span class="gr">    //K2 = 8;</span>
<span class="gr">    //PEFactor = 5;</span>
<span class="gr">};</span>
</pre></div>
</div>
<p>Several of these elements are described already in the two-element model
above, but some are new and described in the table below. No excuse we
can make is going to soften the fact that muscle modeling at this level
of detail is a technical matter, and it is not possible to describe the
physiological and mathematical background in detail. Instead please
refer to the publications at the end of this lesson for further
information:</p>
<table border="1" class="docutils">
<colgroup>
<col width="2%" />
<col width="98%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Gammabar</th>
<th class="head">Gamma is the so-called pennation angle. It reflects that fact that most muscles have the fibers misaligned with the directions of action of the muscle. Gamma changes when the muscle extends or contracts, and Gammabar is the value of Gamma in the muscle’s neutral position. It is possible to find values for Gammabar for most major muscles in the human body in the anatomical literature. Gammabar is measured in radians.</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Fcfast</td>
<td><p class="first">Muscle fibers come in two flavors: fast twitch and slow twitch, and the composition of these vary between the muscles as well as between individuals. Fast fibers, as the name indicates, have the ability of fast action at the cost of stamina, and slow fibers have opposite properties. Sprint runners have a high proportion of fast twitch muscles while marathon runners have many slow twitch muscles.</p>
<p class="last">Fcfast is the fraction of fast twitch fibers in the muscle. It is a fraction&nbsp;between 0 and 1 and hence dimensionless.</p>
</td>
</tr>
<tr class="row-odd"><td>Jt and Jpe</td>
<td><p class="first">Jt and Jpe are elasticity factors for the tendon (serial-elastic) and parallel-elastic elements respectively. The background of these parameters&nbsp;is that the model presumes a nonlinear elasticity of these elements, and the precise shape of the force-deformation characteristics of the element are determined by Jt and Jpe respectively. In essence, Jt and Jpe are material constants and should not vary too much between different muscles or individuals.</p>
<p class="last">Recommended values are Jt = Jpe = 3.0. These two parameters are dimensionless.</p>
</td>
</tr>
<tr class="row-even"><td>K1 and K2</td>
<td><p class="first">These two factors are used only to ensure a reasonable relationship between fiber length, fiber composition, and Fcfast. As discussed in the preceding section, the strength of a muscle tapers off when its contraction velocity grows. Rather than working with a given maximum contraction speed as the two-element model does, K1 and K2 enable us to link the maximum contraction speed to the physiological&nbsp;properties of the muscle. The idea is that muscles with longer fibers and a larger fraction of fast twitch muscles should have a higher maximum contraction velocity.</p>
<p class="last">Preferred values for K1 and K2 differ&nbsp;significantly between authors in the scientific literature, but a good guess would be K1 = 2 and K2 = 8. K1 and K2 formally have the unit of fractions per time unit, i.e. s<sup>-1</sup>.</p>
</td>
</tr>
<tr class="row-odd"><td>PEFactor</td>
<td><p class="first">This factor is related to Jpe. Where Jpe controls the shape of the nonlinearity, PEFactor controls the steepness of the force in the parallel-elastic element as it is elongated. If we imagine a completely inactive muscle and load the muscle with a force corresponding to the active strength of the muscle, i.e. F0, then the length of the elongated muscle fibers will be PEFactor x Lfbar. In other words PEFactor is a dimensionless measure of the flexibility of the parallel-elastic element of the muscle.</p>
<p class="last">Plausible values for PEFactor would be between 1.5 and 5 where the lower end of the interval requires a very careful tuning of the muscle to the skeleton to avoid unreasonably large passive forces.</p>
</td>
</tr>
</tbody>
</table>
<p>Knowing the significance of the different parameters, let us pick
reasonable values for Muscle2 and study their influences:</p>
<div class="highlight-AnyScriptDoc"><div class="highlight"><pre><span></span><span class="kt">AnyMuscleModel3E</span> <span class="gr">Model3</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">F0</span> <span class="o">=</span> <span class="gr">100</span><span class="p">;</span>
    <span class="n">Lfbar</span> <span class="o">=</span> <span class="gr">0.3</span><span class="p">;</span>
    <span class="n">Gammabar</span> <span class="o">=</span> <span class="gr">30*pi/180</span><span class="p">;</span>
    <span class="n">Epsilonbar</span> <span class="o">=</span> <span class="gr">0.05</span><span class="p">;</span>
    <span class="n">Lt0</span> <span class="o">=</span> <span class="gr">0.5</span><span class="p">;</span>
    <span class="n">Fcfast</span> <span class="o">=</span> <span class="gr">0.4</span><span class="p">;</span>
    <span class="gr">Jt = 3.0</span><span class="p">;</span>
    <span class="gr">Jpe = 3.0</span><span class="p">;</span>
    <span class="gr">K1 = 2</span><span class="p">;</span>
    <span class="gr">K2 = 8</span><span class="p">;</span>
    <span class="gr">PEFactor = 5</span><span class="p">;</span>
  <span class="p">};</span>
</pre></div>
</div>
<p>Notice that Lfbar + Lt0 = 0.8, which is in the range of the Lmt
variation of Muscle2. This is important because it gives the muscle a
reasonable chance of spanning the origin-insertion length.</p>
<p>We also have to associate Muscle2 with the new muscle model:</p>
<div class="highlight-AnyScriptDoc"><div class="highlight"><pre><span></span><span class="kt">AnyShortestPathMuscle</span> <span class="n">Muscle2</span> <span class="o">=</span> <span class="p">{</span>
  <span class="kt">AnyMuscleModel</span> <span class="o">&amp;</span><span class="n">Model</span> <span class="o">=</span> <span class="p">.</span><span class="gr">Model3</span><span class="p">;</span>
  <span class="kt">AnyRefFrame</span> <span class="o">&amp;</span><span class="n">Orig</span> <span class="o">=</span> <span class="p">.</span><span class="n">GlobalRef</span><span class="p">.</span><span class="n">M2Origin</span><span class="p">;</span>
  <span class="kt">AnySurface</span> <span class="o">&amp;</span><span class="n">srf</span> <span class="o">=</span> <span class="p">.</span><span class="n">GlobalRef</span><span class="p">.</span><span class="n">CylCenter</span><span class="p">.</span><span class="n">WrapSurf</span><span class="p">;</span>
  <span class="kt">AnyRefFrame</span> <span class="o">&amp;</span><span class="n">Ins</span> <span class="o">=</span> <span class="p">.</span><span class="n">Arm</span><span class="p">.</span><span class="n">M2Insertion</span><span class="p">;</span>
  <span class="n">SPLine</span><span class="p">.</span><span class="n">StringMesh</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
  <span class="n">SPLine</span><span class="p">.</span><span class="n">InitWrapPosVectors</span> <span class="o">=</span> <span class="p">{{</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">},{</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">}};</span>
  <span class="kt">AnyDrawMuscle</span> <span class="n">drw</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">Bulging</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">ColorScale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">MaxStress</span> <span class="o">=</span> <span class="mi">250000</span><span class="p">;</span>
  <span class="p">};</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Finally, to have a more clean-cut case, we temporarily remove the
external force that we previously added</p>
<div class="highlight-AnyScriptDoc"><div class="highlight"><pre><span></span><span class="gr">/*</span><span class="cm"></span>
<span class="cm">    AnyForce3D Load = {</span>
<span class="cm">      AnyRefNode &amp;Attachment = .Arm.Hand;</span>
<span class="cm">      F = {-100, -100, 0};</span>
<span class="cm">    };</span>

<span class="gr">*/</span>
</pre></div>
</div>
<p>We are ready to try running the InverseDynamicAnalysis again. Load the
model, pick InverseDynamicAnalysis in the operations tree, and click the
Run button. The arm should move as is did in the previous section. Now,
using a Chart View we can investigate the behavior of the new muscle. In
the Chart View’s tree, expand the folders as far as Muscle2, and try
charting some of the parameters.</p>
<p>The key to understanding the muscle’s behavior is to study the forces in
the muscle’s different elements. The chart of Fm, which is the force in
the muscle’s contractile element, is very uninteresting. This muscle
does not contribute to carrying the load, and hence the system does not
activate it. But the muscle is not without force. The property Fp, which
is the force in the parallel-elastic element of the muscle has the
following behavior:</p>
<p><img alt="Force parallel elastic element" src="../_images/image101.png" /></p>
<p>In the initial phase of the movement, the parallel-elastic element is
slack and adds no force to the muscle. But as the muscle gets extended,
the passive muscle force sets in, and it continues to rise as the
movement progresses. Notice that this passive force acts against the
movement and hence requires Muscle1 to work that much more. But the
passive force has another interesting effect, which we can see if we
chart the property Lt, i.e. the length of the tendon (Notice that we
have changed the scale of the&nbsp;ordinate axis):</p>
<p><img alt="Tendon length plot" src="../_images/image1111.png" /></p>
<p>From the time the passive force sets in, the tendon starts to elongate a
little bit.</p>
<p>The total origin-insertion length of the muscle-tendon unit is the
tendon length plus the muscle length, i.e. Lm + Lt. When Lt is
stretched, the effect is that the muscle fibers stretch that much less,
and since the muscle’s strength depends on the momentary length of the
contractile element, the strain in the tendon can influence the strength
of the muscle. The figure above shows that the tendon stretch is rather
limited and we might therefore expect that the influence on the muscle
strength is also limited. However, some muscles in the human body (for
instance m. soleus) have the property of relatively short fibers and a
long tendon, and in this case the effect can be significant.</p>
<p>The three-element muscle model attempts to take this into account in the
computation of muscle activity, coping with the fact that this is a
catch 22 type of problem in inverse dynamics:</p>
<ul class="simple">
<li>We cannot compute the elongation of the tendon until we know the
force in the muscle.</li>
<li>We do not know the force in the muscle until we have solved the
muscle recruitment problem.</li>
<li>To solve the muscle recruitment we need the momentary strength of
each muscle.</li>
<li>The momentary strength depends on the elongation of the tendon.</li>
</ul>
<p>We seem to be faced with a circular dependency between the muscle
properties. The three-element model copes with this through a one-time
correction: It recruits the muscle without taking the tendon elongation
into account. Then it computes the tendon elongation. Finally, it
computes the influence of the elongation on the muscle’s strength and
corrects the muscle activity to the level that provides the necessary
force with the modified strength. This is only an approximative
solution&nbsp;because the change of muscle strength may theoretically alter
the distribution of force between the muscles, and this alteration is
not done by the system; the correction is local to each muscle.</p>
<p>So much for passive properties. It is more instructive to investigate a
muscle model with active force. The easiest way to do so is to enable
our hand force again and change it to point directly upward. This causes
the previously inactive Muscle2 to become active:</p>
<div class="highlight-AnyScriptDoc"><div class="highlight"><pre><span></span> <span class="c1">// Define one simple segment</span>
 <span class="kt">AnySeg</span> <span class="n">Arm</span> <span class="o">=</span> <span class="p">{</span>
   <span class="n">r</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.000000</span><span class="p">,</span> <span class="mf">0.000000</span><span class="p">};</span>
   <span class="n">Mass</span> <span class="o">=</span> <span class="mf">1.000000</span><span class="p">;</span>
   <span class="n">Jii</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.100000</span><span class="p">,</span> <span class="mf">1.000000</span><span class="p">,</span> <span class="mf">1.000000</span><span class="p">}</span><span class="o">*</span><span class="mf">0.1</span><span class="p">;</span>
   <span class="kt">AnyRefNode</span> <span class="n">Jnt</span> <span class="o">=</span> <span class="p">{</span>
     <span class="n">sRel</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>
   <span class="p">};</span>
   <span class="kt">AnyRefNode</span> <span class="n">M1Insertion</span> <span class="o">=</span> <span class="p">{</span>
     <span class="n">sRel</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>
   <span class="p">};</span>
   <span class="kt">AnyRefNode</span> <span class="n">M2Insertion</span> <span class="o">=</span> <span class="p">{</span>
     <span class="n">sRel</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">};</span>
   <span class="p">};</span>
   <span class="kt">AnyRefNode</span> <span class="n">ViaPoint</span> <span class="o">=</span> <span class="p">{</span>
     <span class="n">sRel</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>
   <span class="p">};</span>
   <span class="kt">AnyRefNode</span> <span class="n">Hand</span> <span class="o">=</span> <span class="p">{</span>
     <span class="n">sRel</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>
   <span class="p">};</span>
   <span class="kt">AnyDrawSeg</span> <span class="n">drw</span> <span class="o">=</span> <span class="p">{};</span>
 <span class="p">};</span>

<span class="gr">AnyForce3D Load = {</span>
<span class="gr">   AnyRefNode &amp;Attachment = .Arm.Hand;</span>
<span class="gr">   F = {0, 10, 0};</span>
<span class="gr"> };</span>
</pre></div>
</div>
<p>With this we can run the InverseDynamicAnalysis again and get the muscle
to do some work. Let us systematically investigate the output:</p>
<table border="1" class="colwidths-given styled-table docutils" id="id1">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">Optional Caption</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="50%" />
<col width="30%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td class="left-align nowrap">Fin</td>
<td class="left-align">This is a force, but it has not physiological significance for a muscle except for internal purposes. The reason why it is included in the output is that it is inherited from the AnyScript classes that a muscle is derived from.</td>
<td class="center-align nowrap">&#160;</td>
</tr>
<tr class="row-even"><td class="left-align nowrap">Fout</td>
<td class="left-align">This is a force, but it has not physiological significance for a muscle except for internal purposes. The reason why it is included in the output is that it is inherited from the AnyScript classes that a muscle is derived from.</td>
<td class="center-align nowrap">&#160;</td>
</tr>
<tr class="row-odd"><td class="left-align nowrap">Lmt</td>
<td class="left-align">The length of the muscle-tendon unit. If you plot this property you will see that it rises almost linearly as the muscle is extended. Closer investigation, however, will reveal that it is offset slightly by the nonlinearity caused by the elongation of the tendon due to the varying force.</td>
<td class="center-align nowrap"><img alt="Small Lmt plot" src="../_images/image1211.png" /></td>
</tr>
<tr class="row-even"><td class="left-align nowrap">Lm</td>
<td class="left-align">The length of the contractile element.</td>
<td class="center-align nowrap"><img alt="small Lm plot" src="../_images/image137.png" /></td>
</tr>
<tr class="row-odd"><td class="left-align nowrap">Lt</td>
<td class="left-align">The length of the tendon. This appears to be constant, but the tendon length actually changes slightly over the movement with the changes of muscle force as described above.</td>
<td class="center-align nowrap"><img alt="Small Lt plot" src="../_images/image141.png" /></td>
</tr>
<tr class="row-even"><td class="left-align nowrap">LmtDot</td>
<td class="left-align">The contraction velocity of the muscle-tendon unit. The value is positive because the muscle is getting longer.</td>
<td class="center-align nowrap"><img alt="Small LmtDot plot" src="../_images/image151.png" /></td>
</tr>
<tr class="row-odd"><td class="left-align nowrap">LmDot</td>
<td class="left-align">The contraction velocity of the contractile element of the muscle. The value is positive because the muscle is getting longer.</td>
<td class="center-align nowrap"><img alt="Small LmDot plot" src="../_images/image151.png" /></td>
</tr>
<tr class="row-even"><td class="left-align nowrap">Activity</td>
<td class="left-align">This is the muscle activity before correction for the change in muscle length caused by the elastic elongation of the muscle. The complicated variation is caused by the interplay between change of moment arm of the applied force, the passive force in the muscle&nbsp;and the change of muscle strength with the contraction.</td>
<td class="center-align nowrap"><img alt="Small activity plot" src="../_images/image161.png" /></td>
</tr>
<tr class="row-odd"><td class="left-align nowrap">Corrected-Activity</td>
<td class="left-align">This is the muscle activity after correction for the tendon elongation.&nbsp;The difference between this graph and the one above is that the activity toward the end is higher after correction. This can be difficult to understand and illustrates the complexity of muscle modeling. The reason is the following: The force in the muscle reduces towards the end of the movement. When the force is reduced, the tendon contracts, and this means that the muscle must elongate even more. Since the muscle length is already in the interval where further elongation will cause decreased strength, the tendon contraction has the effect of increasing the muscle activity.</td>
<td class="center-align nowrap"><img alt="Small c-activity plot" src="../_images/image171.png" /></td>
</tr>
<tr class="row-even"><td class="left-align nowrap">Fm</td>
<td class="left-align">The force in the contractile element is decreasing throughout the movement because the moment arm of the external force is reducing and also because the passive force in the muscle is contributing more and more to balancing the load.</td>
<td class="center-align nowrap"><img alt="Small Fm plot" src="../_images/image181.png" /></td>
</tr>
<tr class="row-odd"><td class="left-align nowrap">Ft</td>
<td class="left-align">The tendon force shows the reduction of the mucle action by virtue of the reduced external force’s moment arm alone. A simplified explanation is that Ft = Fm + Fp, but this is not entirely true because we also have to account for the pennation angle.</td>
<td class="center-align nowrap"><img alt="Small Ft plot" src="../_images/image191.png" /></td>
</tr>
<tr class="row-even"><td class="left-align nowrap">Fp</td>
<td class="left-align">The passive force in the muscle increases as the muscle is stretched.</td>
<td class="center-align nowrap"><img alt="Small Fp plot" src="../_images/image20.png" /></td>
</tr>
<tr class="row-odd"><td class="left-align nowrap">Strength</td>
<td class="left-align">This is the strength of the muscle. It is not corrected for the tendon elongation.</td>
<td class="center-align nowrap"><img alt="Small strength plot" src="../_images/image2110.png" /></td>
</tr>
<tr class="row-even"><td class="left-align nowrap">Ft0</td>
<td class="left-align">The hypothetical force that the tendon would have if the activity of the muscle were zero. The reason why this is slightly different from Fp is that Ft0 acts directly along the action line of the muscle while Fp is diverted by the pennation angle. This property is mostly interesting to scientists involved in detailed modeling of single muscles.</td>
<td class="center-align nowrap"><img alt="Small Ft0 plot" src="../_images/image2210.png" /></td>
</tr>
<tr class="row-odd"><td class="left-align nowrap">Ft0Grad</td>
<td class="left-align">The gradient of Ft0 with respect to the muscle activity. For mathematical reasons&nbsp;this is&nbsp;equal to the Strength, and the two graphs are identical. The reason why this property is included under to different names is that the simple muscle model, from which this model is derived, does not have Ft0Grad and hence needs a Strength property.</td>
<td class="center-align nowrap"><img alt="Small Ft0Grad plot" src="../_images/image231.png" /></td>
</tr>
<tr class="row-even"><td class="left-align nowrap">Pennation-Angle</td>
<td class="left-align">The pennation angle is the angle between the muscle fiber direction and the muscle line of action. This angle changes when the muscle contracts and elongates, and the model takes this effect into account.</td>
<td class="center-align nowrap"><img alt="Small pennation angle plot" src="../_images/image241.png" /></td>
</tr>
<tr class="row-odd"><td class="left-align nowrap">EPOTt</td>
<td class="left-align">The elastic potential energy stored in the tendon.</td>
<td class="center-align nowrap"><img alt="Small EPOTt plot" src="../_images/image251.png" /></td>
</tr>
<tr class="row-even"><td class="left-align nowrap">EPOTp</td>
<td class="left-align">The elastic potential energy stored in the parallel-elastic element of the muscle.</td>
<td class="center-align nowrap"><img alt="Small EPOTp plot" src="../_images/image261.png" /></td>
</tr>
<tr class="row-odd"><td class="left-align nowrap">EPOTmt</td>
<td class="left-align">The elastic potential energy stored in the entire muscle-tendon unit. This can have some practical significance for investigation of movement economy and sports activities in general.</td>
<td class="center-align nowrap"><img alt="Small EPOTmt plot" src="../_images/image271.png" /></td>
</tr>
<tr class="row-even"><td class="left-align nowrap">Pt</td>
<td class="left-align">The rate of change of elastic potential energy in the tendon.</td>
<td class="center-align nowrap">&#160;</td>
</tr>
<tr class="row-odd"><td class="left-align nowrap">Pm</td>
<td class="left-align">The mechanical power of the contractile element.</td>
<td class="center-align nowrap"><img alt="Small Pm plot" src="../_images/image281.png" /></td>
</tr>
<tr class="row-even"><td class="left-align nowrap">Pmt</td>
<td class="left-align">The mechanical power of the entire muscle-tendon unit, i.e. the rate of work performed on the skeleton. Notice that the power is negative because the muscle is extending against the force. Muscles behaving like this in the human body are often termed antagonistic muscles.</td>
<td class="center-align nowrap"><img alt="Small Pmt plot" src="../_images/image291.png" /></td>
</tr>
<tr class="row-odd"><td class="left-align nowrap">Pmet</td>
<td class="left-align">A crude estimate of the metabolism in the muscle. The estimate is based on presumed efficiencies of the contractile element of 25% for concentric work and -120% for eccentric work. The model does not take the metabolism of isometric force into account.</td>
<td class="center-align nowrap"><img alt="Small Pmet" src="../_images/image30.png" /></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="calibration">
<h2>Calibration<a class="headerlink" href="#calibration" title="Permalink to this headline">¶</a></h2>
<p>One of the practical challenges in working with detailed muscle models
in complex musculoskeletal systems is the dependency on defined tendon
length,&nbsp;Lt0. A brief experiment with our model can reveal where the
difficulty lies. In the model we have just investigated, the activity of
Muscle2 has the following development over the movement:</p>
<p><img alt="Calibration. Lt0 plot" src="../_images/image3110.png" /></p>
<p>But what would happen if our guess of tendon length, Lt0, in the muscle
model definition&nbsp;was just slightly off the correct value? Well if we
change the current value from 0.5 m to 0.45 m, i.e. a reduction of 10%,
we get the following activity:</p>
<p><img alt="Calibration Activity plot" src="../_images/image3210.png" /></p>
<p>Not only is the shape of the graph different; the maximum activity is
also significantly higher. An error of 10% in&nbsp;an anthropometric
data&nbsp;value is not uncommon considering the accuracy of measurement
methods and variation between individuals, and if the influence on the
final result is as strong as this, we would not be able to trust our
results. The problem is even more difficult if we desire to scale models
up and down in size: Muscles pass along complex paths from origin to
insertion, and the lengths of these paths do not scale in a simple
fashion with, for instance, overall subject height.</p>
<p>As usual in biomechanical modeling, the solution can be found by relying
on nature’s ability to make the best of its resources. Nature has not
equipped humans with tendons whose lengths are very disadvantageous for
our normal activities. We can use this knowledge to calibrate the tendon
lengths for an individual of a certain size. Quite simply, we shall
presume that the tendon lengths are calibrated by nature to provide the
muscles with optimum fiber lengths at certain postures. The AnyBody
Modeling System provides two ways to do that: One is cheap and dirty,
and the other one requires additional information. Let us take a closer
look at them:</p>
<div class="section" id="cheap-and-dirty">
<h3>Cheap and dirty<a class="headerlink" href="#cheap-and-dirty" title="Permalink to this headline">¶</a></h3>
<p>The <em>cheap and dirty</em> solution is of course easily available but also
not recommended for accurate analysis.</p>
<p>You must make an AnyBodyCalibrationStudy, which is the study type
specially designed for doing calibrations of muscle and ligament
objects. The AnyBodyCalibrationStudy needs a model definitions and
motion/posture information in order to perform the calibration. In the
<em>cheap and dirty</em> solution, we simply use the same model definition,
hereunder the motion/posture, of your original AnyBodyStudy. You simply
need to insert the same references to the model in the
AnyBodyCalibrationStudy folder as you have in your AnyBodyStudy model.</p>
<p>Adding a single AnyBodyCalibrationStudy object next to your AnyBodySyudy
this way, allow you to run its operation called TendonLenghtAdjustment.
If you run it, you will see the model moving as it does when running the
InverseDynamics operation of the original AnyBodyStudy. But when the
analysis is done, the following message appears in the message window:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>The tendon length of muscle Main.MyModel.Muscle2 was calibrated.
The muscle properties have been updated.
</pre></div>
</div>
<p>Try running the InverseDynamics again and plot the Activity of Muscle2.
You should see the following:</p>
<p><img alt="Cheap n dirty calibration, Activity plot" src="../_images/image331.png" /></p>
<p>As you can see, this is again very different from what we have seen
before. Plotting the strength will reveal what has happened:</p>
<p><img alt="Cheap n dirty calibration, activity plot" src="../_images/image341.png" /></p>
<p>What the&nbsp;MuscleCalibrationAnalysis does is to run through the specified
movement and compute the variation of the origin-insertion length of the
muscle. It subsequently changes the user-defined value of Lt0 such that
the length of the contractile element equals the optimum fiber length,
Lm0, when the origin-insertion length is at its mean value. Notice that
this does not necessarily correspond to the length when 50% of the
movement has passed.</p>
<p>The rationale behind this method of tendon length calibration is that if
you analyze a movement that is representative for what the body is
created to do, then the muscles should probably attain their optimum
fiber lengths somewhere safely within the interval of movement.
Naturally this is not a very accurate way of doing it, and it will not
work if you are modeling a movement that is outside the typical posture
of the joints in the model.</p>
<p>Please notice that the tendon lengths specified in the AnyScript model
are not altered by this method. Every time you reload the model you must
run the MuscleCalibrationAnalysis again.</p>
</div>
<div class="section" id="detailed-calibration">
<h3>Detailed calibration<a class="headerlink" href="#detailed-calibration" title="Permalink to this headline">¶</a></h3>
<p>There is a more accurate and detailed way of calibrating tendons, but it
requires additional information. More precisely it calibrates the tendon
lengths at user-defined joint postures. So each muscle is associated
with a certain set of joint postures for which the muscle is presumed to
be at its neutral position. Please notice that the set of neutral joint
postures is in principle different for each muscle in the system. In
practice the calibration usually takes place on sets of muscles at a
time, where all the muscles in a set is calibrated at the same joint
postures. This way, all the muscles in a complicated system can be
calibrated with a reasonable number of operations.</p>
<p>Detailed calibration of tendon lengths is covered in the <a class="reference internal" href="../MuscleRecruitment/Inverse_dynamics.html"><span class="doc">“Inverse
Dynamics of Muscle Systems”
tutorial*</span></a>.
Calibration of ligaments is much the same type of process and is
described in detail in the <a class="reference internal" href="lesson7.html"><span class="doc">*Ligament tutorial, Lesson
7*</span></a>.</p>
<p>But before we come to ligaments we must cover one last aspect of muscle
modeling, namely General Muscles. They are the topic of the next lesson,
<a class="reference internal" href="lesson6.html"><span class="doc">Lesson 6</span></a>.</p>
<div class="without-title admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><strong>Next lesson:</strong> <a class="reference internal" href="lesson6.html"><span class="doc">Lesson 6: General Muscles</span></a>.</p>
</div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>Hill, A.: The heat of shortening and the dynamics constants of a muscle.
Proc. Roy. Soc. B., 126, 136-195, 1938.</p>
<p>Huxley, A.: Muscle structure and theories of contraction, Progr.
Biophys. 7, 255-318.</p>
<p>Zajac, F.E.: Muscle and Tendon: Properties, Models, Scling, and
Application to Biomechanics and Motor Control. Critical Reviews in
Biomedical Engineering, 17, 359-410, 1989.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="../index.html" title="index">
          <img class="logo" src="../_static/anybody_tutorials_logo.png" alt="Logo"/>
        </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<div class="sphinx-toc sphinxglobaltoc">
<h3><a href="../contents.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Tutorial overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../A_Getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../A_Getting_started_anyscript/index.html">Getting started: AnyScript Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../A_Getting_started_modeling/index.html">Getting Started with Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Interface_features/index.html">User interface features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../A_study_of_studies/index.html">A Study of Studies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Making_things_move/index.html">Making things move</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MuscleRecruitment/index.html">Inverse Dynamics of Muscle Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ForceDependentKinematics/index.html">Force-Dependent Kinematics</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Muscle Modeling</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="lesson1.html">Lesson 1: The Basics of Muscle Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="lesson2.html">Lesson 2: Controlling Muscle Drawing</a></li>
<li class="toctree-l2"><a class="reference internal" href="lesson3.html">Lesson 3: Via-point muscles</a></li>
<li class="toctree-l2"><a class="reference internal" href="lesson4.html">Lesson 4: Wrapping Muscles</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Lesson 5: Muscle Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#anymusclemodel2elin">AnyMuscleModel2ELin</a></li>
<li class="toctree-l3"><a class="reference internal" href="#anymusclemodel3e">AnyMuscleModel3E</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calibration">Calibration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cheap-and-dirty">Cheap and dirty</a></li>
<li class="toctree-l4"><a class="reference internal" href="#detailed-calibration">Detailed calibration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lesson6.html">Lesson 6: General Muscles</a></li>
<li class="toctree-l2"><a class="reference internal" href="lesson7.html">Lesson 7: Ligaments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../The_mechanical_elements/index.html">The Mechanical Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Advanced_script_features/index.html">Advanced Script Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Finite_element_analysis/index.html">Finite Element Analysis Interfacing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AnyExp4SOLIDWORKS/index.html">Making Models using SOLIDWORKS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Scaling/index.html">Personalizing Your Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Validation_of_models/index.html">Validation of Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Parameter_studies_and_optimization/index.html">Parameter Studies and Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Troubleshooting_anyscript/intro.html">Trouble Shooting AnyScript Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Posture_and_movement/intro.html">Posture and Movement Prediction</a></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/Muscle_modeling/lesson5.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../contents.html" title="Table Of Contents"
             >toc</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="lesson6.html" title="Lesson 6: General Muscles"
             >next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="lesson4.html" title="Lesson 4: Wrapping Muscles"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">AnyBody Tutorials v7.0.1.dev</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" >Muscle Modeling</a> &#187;</li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, AnyBody Technology.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>